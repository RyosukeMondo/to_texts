{
  "id": "snapshot_1760626849595_n4nfpbgdf",
  "approvalId": "approval_1760626678385_gigqlefzm",
  "approvalTitle": "Tasks Document - Multi-Credential Downloader (Revised with TOML)",
  "version": 3,
  "timestamp": "2025-10-16T15:00:49.595Z",
  "trigger": "approved",
  "status": "pending",
  "content": "# Tasks Document\n\n## Phase 1: Core Infrastructure\n\n- [ ] 1. Create Credential Data Model\n  - File: packages/python/zlibrary-downloader/zlibrary_downloader/credential.py\n  - Define CredentialStatus enum (VALID, INVALID, EXHAUSTED)\n  - Define Credential dataclass with all required fields (identifier, email, password, remix_userid, remix_userkey, status, downloads_left, last_used, last_validated)\n  - Add is_available() method to check if credential can be used\n  - Add to_dict() and from_dict() methods for serialization\n  - Purpose: Establish type-safe credential data model\n  - _Leverage: Python dataclasses, enum, datetime_\n  - _Requirements: 1.1, 1.2_\n  - _Prompt: Implement the task for spec multi-credential-downloader. First run spec-workflow-guide to get the workflow guide then implement the task: Role: Python Developer specializing in data modeling and type systems | Task: Create comprehensive Credential data model in packages/python/zlibrary-downloader/zlibrary_downloader/credential.py with CredentialStatus enum and Credential dataclass following requirements 1.1 and 1.2. The dataclass should use type hints and include methods for availability checking and serialization. | Restrictions: Use Python 3.8+ features, follow PEP 8 naming conventions, do not add external dependencies beyond standard library | Success: Credential model is well-defined with proper type hints, serialization methods work correctly, is_available() logic is sound. Mark task as [-] when starting and [x] when complete in .spec-workflow/specs/multi-credential-downloader/tasks.md_\n\n- [ ] 2. Add TOML Parsing Dependency\n  - File: packages/python/zlibrary-downloader/setup.py or requirements.txt or pyproject.toml\n  - Add tomli dependency for Python <3.11 (Python 3.11+ has built-in tomllib)\n  - Add conditional dependency: tomli;python_version<\"3.11\"\n  - Update project dependencies configuration\n  - Purpose: Enable TOML configuration file parsing\n  - _Leverage: Existing dependency management setup_\n  - _Requirements: 5.1_\n  - _Prompt: Implement the task for spec multi-credential-downloader. First run spec-workflow-guide to get the workflow guide then implement the task: Role: DevOps Engineer with expertise in Python packaging | Task: Add tomli dependency to project dependencies in packages/python/zlibrary-downloader/ following requirement 5.1. Add conditional dependency for Python versions <3.11 since Python 3.11+ has built-in tomllib. Update setup.py, requirements.txt, or pyproject.toml as appropriate for the project structure. | Restrictions: Use conditional dependency syntax (tomli;python_version<\"3.11\"), do not break existing dependencies, follow project's dependency management pattern | Success: tomli dependency added correctly with version constraint, conditional for Python <3.11, project can be installed successfully on both Python 3.10 and 3.11+. Mark task as [-] when starting and [x] when complete in .spec-workflow/specs/multi-credential-downloader/tasks.md_\n\n- [ ] 3. Write Credential Model Unit Tests\n  - File: packages/python/zlibrary-downloader/tests/test_credential.py\n  - Test CredentialStatus enum values\n  - Test Credential dataclass instantiation with various combinations\n  - Test is_available() method logic\n  - Test to_dict() and from_dict() serialization\n  - Achieve >80% code coverage\n  - Purpose: Ensure credential model reliability\n  - _Leverage: pytest framework_\n  - _Requirements: 1.1, 1.2_\n  - _Prompt: Implement the task for spec multi-credential-downloader. First run spec-workflow-guide to get the workflow guide then implement the task: Role: QA Engineer with expertise in Python unit testing and pytest | Task: Create comprehensive unit tests for Credential model in packages/python/zlibrary-downloader/tests/test_credential.py covering requirements 1.1 and 1.2. Test all enum values, dataclass instantiation, availability logic, and serialization/deserialization. | Restrictions: Use pytest framework, test both success and failure scenarios, ensure test isolation, aim for >80% coverage | Success: All Credential functionality is tested, edge cases covered, tests run independently and pass consistently. Mark task as [-] when starting and [x] when complete in .spec-workflow/specs/multi-credential-downloader/tasks.md_\n\n- [ ] 4. Implement Rotation State Persistence\n  - File: packages/python/zlibrary-downloader/zlibrary_downloader/rotation_state.py\n  - Define RotationState class with state_file path\n  - Implement save() method to write JSON state file\n  - Implement load() method to read JSON state file\n  - Implement exists() and validate() methods\n  - Handle missing and corrupted state files gracefully\n  - Set proper file permissions (chmod 600 on Unix)\n  - Purpose: Provide persistent rotation state storage\n  - _Leverage: json, pathlib, os modules_\n  - _Requirements: 5.1, 5.2_\n  - _Prompt: Implement the task for spec multi-credential-downloader. First run spec-workflow-guide to get the workflow guide then implement the task: Role: Python Developer with expertise in file I/O and state management | Task: Create RotationState class in packages/python/zlibrary-downloader/zlibrary_downloader/rotation_state.py for persistent state storage following requirements 5.1 and 5.2. Implement JSON-based save/load with corruption handling and proper file permissions. | Restrictions: Use only standard library (json, pathlib, os), handle file permissions cross-platform, ensure atomic writes, validate JSON structure | Success: State can be saved and loaded reliably, corrupted files handled gracefully, file permissions set correctly on Unix systems. Mark task as [-] when starting and [x] when complete in .spec-workflow/specs/multi-credential-downloader/tasks.md_\n\n- [ ] 5. Write Rotation State Unit Tests\n  - File: packages/python/zlibrary-downloader/tests/test_rotation_state.py\n  - Test save() and load() methods\n  - Test handling of missing state files\n  - Test handling of corrupted JSON\n  - Test file permissions on Unix systems\n  - Test state validation logic\n  - Achieve >80% code coverage\n  - Purpose: Ensure state persistence reliability\n  - _Leverage: pytest, tempfile for test isolation_\n  - _Requirements: 5.1, 5.2_\n  - _Prompt: Implement the task for spec multi-credential-downloader. First run spec-workflow-guide to get the workflow guide then implement the task: Role: QA Engineer with expertise in file I/O testing and pytest | Task: Create comprehensive unit tests for RotationState in packages/python/zlibrary-downloader/tests/test_rotation_state.py covering requirements 5.1 and 5.2. Test save/load operations, corruption handling, and file permissions. | Restrictions: Use pytest and tempfile, test cross-platform behavior where applicable, ensure test cleanup, aim for >80% coverage | Success: All state persistence functionality tested, edge cases like corruption and missing files covered, tests are isolated and reliable. Mark task as [-] when starting and [x] when complete in .spec-workflow/specs/multi-credential-downloader/tasks.md_\n\n- [ ] 6. Implement Credential Manager Core\n  - File: packages/python/zlibrary-downloader/zlibrary_downloader/credential_manager.py\n  - Create CredentialManager class with credentials list and current_index\n  - Implement detect_credential_source() to check for TOML file or .env\n  - Implement load_from_toml() to parse zlibrary_credentials.toml using tomllib/tomli\n  - Implement load_from_env() to parse single credential from .env (backward compatible)\n  - Implement get_current() to return currently active credential\n  - Implement rotate() to move to next available credential with wrap-around\n  - Implement get_available() to filter out invalid/exhausted/disabled credentials\n  - Integrate with RotationState for state persistence\n  - Purpose: Manage credential lifecycle and rotation logic\n  - _Leverage: Credential model, RotationState, tomllib/tomli for TOML, python-dotenv for .env_\n  - _Requirements: 1.1, 2.1, 2.2, 2.3, 5.1_\n  - _Prompt: Implement the task for spec multi-credential-downloader. First run spec-workflow-guide to get the workflow guide then implement the task: Role: Python Developer specializing in business logic and configuration management | Task: Create CredentialManager class in packages/python/zlibrary-downloader/zlibrary_downloader/credential_manager.py following requirements 1.1, 2.1, 2.2, 2.3, and 5.1. Implement auto-detection of configuration source (zlibrary_credentials.toml or .env), TOML parsing using tomllib (Python 3.11+) or tomli (older versions), and maintain backward compatibility with single-credential .env format. Implement rotation logic with wrap-around and state persistence integration. | Restrictions: Must support backward compatibility with single-credential .env, handle edge cases like all credentials exhausted, skip disabled credentials in TOML, follow single responsibility principle, use try/except for tomllib import fallback | Success: Credentials load from TOML file with unlimited accounts, .env single-credential format still works, rotation works with proper wrap-around, state persists correctly, disabled credentials are filtered out. Mark task as [-] when starting and [x] when complete in .spec-workflow/specs/multi-credential-downloader/tasks.md_\n\n- [ ] 7. Implement Credential Validation\n  - File: packages/python/zlibrary-downloader/zlibrary_downloader/credential_manager.py (extend)\n  - Add validate_credential() method that tests credential with Zlibrary client\n  - Use getProfile() API call to verify credential validity\n  - Update credential status based on validation result\n  - Fetch download limits during validation\n  - Add update_downloads_left() method\n  - Handle network errors with retry logic (2 attempts)\n  - Purpose: Verify credential validity and track quotas\n  - _Leverage: Existing Zlibrary client (packages/python/zlibrary-downloader/zlibrary_downloader/client.py)_\n  - _Requirements: 1.3, 1.4, 4.1, 4.2_\n  - _Prompt: Implement the task for spec multi-credential-downloader. First run spec-workflow-guide to get the workflow guide then implement the task: Role: Python Developer with expertise in API integration and error handling | Task: Extend CredentialManager in packages/python/zlibrary-downloader/zlibrary_downloader/credential_manager.py with validation methods following requirements 1.3, 1.4, 4.1, and 4.2. Implement credential validation using Zlibrary client's getProfile() method, download limit tracking, and robust error handling with retries. | Restrictions: Reuse existing Zlibrary client, never log passwords, implement retry logic (max 2 attempts), handle network timeouts gracefully | Success: Credentials validate correctly against Z-Library API, download limits fetched and tracked, network errors handled with retries, no sensitive data logged. Mark task as [-] when starting and [x] when complete in .spec-workflow/specs/multi-credential-downloader/tasks.md_\n\n- [ ] 8. Write Credential Manager Unit Tests\n  - File: packages/python/zlibrary-downloader/tests/test_credential_manager.py\n  - Test credential loading from TOML file with multiple accounts\n  - Test credential loading from .env (single credential, backward compatibility)\n  - Test auto-detection logic (TOML vs .env)\n  - Test disabled credential filtering from TOML\n  - Test rotation logic and wrap-around behavior\n  - Test get_available() filtering\n  - Test validation with mocked Zlibrary client\n  - Test state persistence integration\n  - Test error handling (all credentials exhausted, invalid, malformed TOML, etc.)\n  - Achieve >80% code coverage\n  - Purpose: Ensure credential management reliability\n  - _Leverage: pytest, unittest.mock for mocking Zlibrary client, tempfile for test TOML files_\n  - _Requirements: 1.1, 1.3, 1.4, 2.1, 2.2, 2.3, 4.1, 4.2, 5.1_\n  - _Prompt: Implement the task for spec multi-credential-downloader. First run spec-workflow-guide to get the workflow guide then implement the task: Role: QA Engineer with expertise in Python testing, mocking, and pytest | Task: Create comprehensive unit tests for CredentialManager in packages/python/zlibrary-downloader/tests/test_credential_manager.py covering requirements 1.1, 1.3, 1.4, 2.1, 2.2, 2.3, 4.1, 4.2, and 5.1. Mock Zlibrary client for validation tests, test TOML parsing with multiple accounts, test single-credential .env format for backward compatibility, test disabled credential filtering, rotation logic, and error scenarios including malformed TOML. | Restrictions: Use pytest and unittest.mock, mock external dependencies (Zlibrary client), use tempfile to create test TOML files, test both success and failure paths, ensure test isolation, aim for >80% coverage | Success: All CredentialManager functionality tested including TOML parsing, .env parsing, auto-detection, rotation, validation, disabled credential filtering, and error handling. Tests are reliable and cover edge cases. Mark task as [-] when starting and [x] when complete in .spec-workflow/specs/multi-credential-downloader/tasks.md_\n\n- [ ] 9. Implement Client Pool\n  - File: packages/python/zlibrary-downloader/zlibrary_downloader/client_pool.py\n  - Create ZlibraryClientPool class with credential_manager and clients dict\n  - Implement get_current_client() to return cached or create new Zlibrary client\n  - Implement rotate_client() to rotate credential and return new client\n  - Implement validate_all() to test all credentials\n  - Implement refresh_client() to recreate client for a credential\n  - Cache Zlibrary client instances by credential identifier\n  - Purpose: Manage Zlibrary client instances with credential awareness\n  - _Leverage: CredentialManager, existing Zlibrary client_\n  - _Requirements: 2.1, 3.1, 3.2, 3.3_\n  - _Prompt: Implement the task for spec multi-credential-downloader. First run spec-workflow-guide to get the workflow guide then implement the task: Role: Python Developer specializing in resource management and caching patterns | Task: Create ZlibraryClientPool class in packages/python/zlibrary-downloader/zlibrary_downloader/client_pool.py following requirements 2.1, 3.1, 3.2, and 3.3. Implement client caching by credential identifier, rotation integration with CredentialManager, and validation methods. | Restrictions: Cache clients to avoid repeated authentication, handle credential rotation transparently, properly handle client creation failures, maintain separation of concerns | Success: Clients are properly cached and reused, rotation triggers client switching, validation tests all credentials, client creation errors handled gracefully. Mark task as [-] when starting and [x] when complete in .spec-workflow/specs/multi-credential-downloader/tasks.md_\n\n- [ ] 10. Write Client Pool Unit Tests\n  - File: packages/python/zlibrary-downloader/tests/test_client_pool.py\n  - Test client caching (same credential returns cached client)\n  - Test get_current_client() and rotate_client()\n  - Test validate_all() with various credential states\n  - Test refresh_client() recreates client\n  - Test error handling for client creation failures\n  - Achieve >80% code coverage\n  - Purpose: Ensure client pool reliability\n  - _Leverage: pytest, unittest.mock for mocking CredentialManager and Zlibrary_\n  - _Requirements: 2.1, 3.1, 3.2, 3.3_\n  - _Prompt: Implement the task for spec multi-credential-downloader. First run spec-workflow-guide to get the workflow guide then implement the task: Role: QA Engineer with expertise in caching patterns and integration testing | Task: Create comprehensive unit tests for ZlibraryClientPool in packages/python/zlibrary-downloader/tests/test_client_pool.py covering requirements 2.1, 3.1, 3.2, and 3.3. Test caching behavior, rotation, validation, and error scenarios. | Restrictions: Use pytest and unittest.mock, mock CredentialManager and Zlibrary client, verify caching effectiveness, test error handling, aim for >80% coverage | Success: All ClientPool functionality tested including caching, rotation, validation, and error handling. Tests verify clients are reused appropriately. Mark task as [-] when starting and [x] when complete in .spec-workflow/specs/multi-credential-downloader/tasks.md_\n\n## Phase 2: CLI Integration\n\n- [ ] 11. Update CLI for Multi-Credential Support\n  - File: packages/python/zlibrary-downloader/zlibrary_downloader/cli.py\n  - Refactor load_credentials() to use CredentialManager\n  - Refactor initialize_zlibrary() to use ClientPool\n  - Add display_credential_status() function to show account summary\n  - Update help text and documentation\n  - Maintain backward compatibility with single-credential format\n  - Purpose: Integrate credential management into CLI\n  - _Leverage: CredentialManager, ClientPool_\n  - _Requirements: 1.1, 1.3, 1.4, 1.5, 5.1, 5.2, 5.3, 5.4_\n  - _Prompt: Implement the task for spec multi-credential-downloader. First run spec-workflow-guide to get the workflow guide then implement the task: Role: Full-stack Python Developer with CLI application expertise | Task: Refactor CLI in packages/python/zlibrary-downloader/zlibrary_downloader/cli.py to integrate CredentialManager and ClientPool following requirements 1.1, 1.3, 1.4, 1.5, 5.1, 5.2, 5.3, and 5.4. Update initialization, add credential status display, maintain backward compatibility. | Restrictions: Do not break existing CLI interface, maintain backward compatibility with single credential, preserve existing command-line arguments, follow existing CLI patterns | Success: CLI initializes with CredentialManager and ClientPool, displays credential status on startup, single-credential format still works, help text updated. Mark task as [-] when starting and [x] when complete in .spec-workflow/specs/multi-credential-downloader/tasks.md_\n\n- [ ] 12. Implement Automatic Rotation in Operations\n  - File: packages/python/zlibrary-downloader/zlibrary_downloader/cli.py (extend)\n  - Add rotation call after successful search_books() operation\n  - Add rotation call after successful download_book() operation\n  - Update download limit tracking after downloads\n  - Add logging for rotation events\n  - Handle credential exhaustion gracefully\n  - Purpose: Enable automatic credential switching\n  - _Leverage: ClientPool, CredentialManager_\n  - _Requirements: 2.2, 2.3, 3.2, 3.3, 4.2, 4.3_\n  - _Prompt: Implement the task for spec multi-credential-downloader. First run spec-workflow-guide to get the workflow guide then implement the task: Role: Backend Python Developer with expertise in workflow automation | Task: Extend CLI operations in packages/python/zlibrary-downloader/zlibrary_downloader/cli.py to integrate automatic rotation following requirements 2.2, 2.3, 3.2, 3.3, 4.2, and 4.3. Add rotation after search/download operations, update download limits, implement proper logging. | Restrictions: Only rotate after successful operations, handle errors without losing state, log rotation events (not credentials), maintain operation transparency to user | Success: Rotation occurs automatically after operations, download limits update correctly, exhausted credentials skipped, rotation events logged appropriately. Mark task as [-] when starting and [x] when complete in .spec-workflow/specs/multi-credential-downloader/tasks.md_\n\n- [ ] 13. Implement Graceful Fallback and Error Handling\n  - File: packages/python/zlibrary-downloader/zlibrary_downloader/cli.py (extend)\n  - Add retry logic for failed operations with next credential\n  - Implement automatic skip for exhausted credentials\n  - Add clear error messages for credential issues\n  - Handle \"all credentials exhausted\" scenario\n  - Add warning messages for approaching limits\n  - Purpose: Ensure robust error handling\n  - _Leverage: ClientPool, CredentialManager error handling_\n  - _Requirements: 3.4, 4.3, 4.4, 5.4_\n  - _Prompt: Implement the task for spec multi-credential-downloader. First run spec-workflow-guide to get the workflow guide then implement the task: Role: Python Developer specializing in error handling and resilience patterns | Task: Implement comprehensive error handling in packages/python/zlibrary-downloader/zlibrary_downloader/cli.py following requirements 3.4, 4.3, 4.4, and 5.4. Add retry logic, exhaustion handling, clear error messages, and warning system. | Restrictions: Retry with next credential on failures, do not expose credentials in errors, provide actionable error messages, limit retry attempts to avoid infinite loops | Success: Operations retry with next credential on failure, exhausted credentials skipped automatically, clear error messages displayed, all-exhausted scenario handled gracefully. Mark task as [-] when starting and [x] when complete in .spec-workflow/specs/multi-credential-downloader/tasks.md_\n\n- [ ] 14. Write CLI Integration Tests\n  - File: packages/python/zlibrary-downloader/tests/test_cli_integration.py\n  - Test CLI initialization with multi-credential setup\n  - Test search operation with rotation\n  - Test download operation with rotation and limit tracking\n  - Test backward compatibility with single credential\n  - Test error scenarios (all exhausted, invalid credentials)\n  - Test credential status display\n  - Purpose: Ensure CLI integration works end-to-end\n  - _Leverage: pytest, unittest.mock for API mocking_\n  - _Requirements: All Phase 1-2 requirements_\n  - _Prompt: Implement the task for spec multi-credential-downloader. First run spec-workflow-guide to get the workflow guide then implement the task: Role: QA Engineer with expertise in integration testing and CLI testing | Task: Create comprehensive integration tests for CLI in packages/python/zlibrary-downloader/tests/test_cli_integration.py covering all Phase 1-2 requirements. Test initialization, operations with rotation, backward compatibility, and error scenarios. | Restrictions: Use pytest and mocking for external APIs, test real workflow scenarios, ensure tests are independent, verify both success and failure paths | Success: All CLI integration scenarios tested including initialization, rotation during operations, error handling, and backward compatibility. Tests are reliable and comprehensive. Mark task as [-] when starting and [x] when complete in .spec-workflow/specs/multi-credential-downloader/tasks.md_\n\n## Phase 3: Documentation and Testing\n\n- [ ] 15. Create zlibrary_credentials.toml.example\n  - File: packages/python/zlibrary-downloader/zlibrary_credentials.toml.example\n  - Create TOML example file with multiple credential examples\n  - Show email/password authentication format\n  - Show remix token authentication format\n  - Include comments explaining each field\n  - Document the \"enabled\" flag for disabling accounts\n  - Include optional state_file configuration\n  - Add instructions on how to use the file\n  - Purpose: Provide clear TOML configuration template\n  - _Leverage: TOML format standards_\n  - _Requirements: 1.1, 1.2, 5.1_\n  - _Prompt: Implement the task for spec multi-credential-downloader. First run spec-workflow-guide to get the workflow guide then implement the task: Role: Technical Writer with expertise in configuration documentation | Task: Create comprehensive zlibrary_credentials.toml.example in packages/python/zlibrary-downloader/zlibrary_credentials.toml.example following requirements 1.1, 1.2, and 5.1. Create well-documented TOML example with multiple credentials showing both email/password and remix token auth, with clear comments explaining each field and the enabled/disabled feature. | Restrictions: Use clear, non-technical language, follow TOML syntax standards, include at least 3 example credentials, explain optional fields, show how to enable/disable accounts | Success: zlibrary_credentials.toml.example is clear and comprehensive, includes examples for all credential types with both auth methods, enabled flag is well-documented, easy for users to copy and customize. Mark task as [-] when starting and [x] when complete in .spec-workflow/specs/multi-credential-downloader/tasks.md_\n\n- [ ] 16. Update README.md with Multi-Credential Guide\n  - File: packages/python/zlibrary-downloader/README.md\n  - Add multi-credential setup section with TOML format\n  - Document zlibrary_credentials.toml configuration structure\n  - Explain TOML benefits (unlimited accounts, enable/disable, readable)\n  - Document single-credential .env format (backward compatible)\n  - Explain automatic detection (TOML vs .env)\n  - Explain rotation behavior\n  - Add troubleshooting tips (TOML syntax errors, file not found, etc.)\n  - Include migration guide from .env to TOML\n  - Document Python version requirements (tomli for <3.11)\n  - Purpose: Provide user-facing documentation\n  - _Leverage: Existing README.md structure_\n  - _Requirements: All requirements_\n  - _Prompt: Implement the task for spec multi-credential-downloader. First run spec-workflow-guide to get the workflow guide then implement the task: Role: Technical Writer specializing in user documentation | Task: Update README.md in packages/python/zlibrary-downloader/README.md to document TOML-based multi-credential feature covering all requirements. Add setup instructions for zlibrary_credentials.toml, explain TOML format benefits, document backward compatibility with .env, explain rotation, add troubleshooting, and provide migration guide from .env to TOML. | Restrictions: Write for end-users (not developers), include practical TOML examples, explain syntax clearly, maintain existing README structure, document tomli dependency for Python <3.11 | Success: README clearly explains TOML configuration format, setup instructions are easy to follow with TOML examples, backward compatibility with .env documented, troubleshooting addresses TOML-specific issues, migration path from .env to TOML is clear. Mark task as [-] when starting and [x] when complete in .spec-workflow/specs/multi-credential-downloader/tasks.md_\n\n- [ ] 17. Run Full Test Suite and Fix Issues\n  - Files: All test files\n  - Run pytest on all unit tests\n  - Run integration tests\n  - Generate coverage report (target >80%)\n  - Fix any failing tests\n  - Fix any coverage gaps\n  - Purpose: Ensure all code is tested and working\n  - _Leverage: pytest, coverage.py_\n  - _Requirements: All requirements_\n  - _Prompt: Implement the task for spec multi-credential-downloader. First run spec-workflow-guide to get the workflow guide then implement the task: Role: QA Engineer responsible for test quality and coverage | Task: Execute complete test suite for multi-credential-downloader, generate coverage report, and fix any issues to achieve >80% coverage target. Run all unit and integration tests. | Restrictions: All tests must pass, coverage should be >80% for new code, do not skip or disable tests to achieve coverage, fix root causes not symptoms | Success: All tests pass consistently, coverage report shows >80% for new modules, no critical gaps in test coverage, test suite runs reliably. Mark task as [-] when starting and [x] when complete in .spec-workflow/specs/multi-credential-downloader/tasks.md_\n\n- [ ] 18. Perform End-to-End Manual Testing\n  - Test backward compatibility with single credential .env\n  - Test TOML multi-credential setup with 2-3 accounts\n  - Test TOML file parsing with various configurations\n  - Test enabled/disabled credential filtering\n  - Perform 10+ operations to verify rotation\n  - Test credential exhaustion scenario\n  - Test \"all credentials exhausted\" scenario\n  - Test application restart with state persistence\n  - Test error recovery and fallback\n  - Test TOML syntax error handling\n  - Purpose: Validate real-world usage scenarios\n  - _Leverage: Real or test Z-Library accounts_\n  - _Requirements: All requirements_\n  - _Prompt: Implement the task for spec multi-credential-downloader. First run spec-workflow-guide to get the workflow guide then implement the task: Role: QA Engineer specializing in manual testing and user acceptance | Task: Perform comprehensive end-to-end manual testing of TOML-based multi-credential feature covering all requirements. Test backward compatibility with .env, TOML configuration with multiple accounts, enabled/disabled credentials, rotation across multiple operations, exhaustion scenarios, state persistence, TOML syntax error handling, and error recovery. | Restrictions: Test with real workflow scenarios, verify user-visible behavior, document any issues found, test both happy path and error scenarios, test TOML-specific features | Success: All user scenarios work as expected, TOML configuration loads correctly, backward compatibility with .env verified, enabled/disabled filtering works, rotation works across 10+ operations, state persists correctly, errors handled gracefully, TOML syntax errors reported clearly. Mark task as [-] when starting and [x] when complete in .spec-workflow/specs/multi-credential-downloader/tasks.md_\n\n- [ ] 19. Code Review and Cleanup\n  - Review all new code for quality\n  - Ensure consistent code style (PEP 8)\n  - Add type hints where missing\n  - Update docstrings for all public methods\n  - Remove debug logging\n  - Optimize performance where applicable\n  - Purpose: Ensure code quality and maintainability\n  - _Leverage: pylint, mypy, black for formatting_\n  - _Requirements: All requirements_\n  - _Prompt: Implement the task for spec multi-credential-downloader. First run spec-workflow-guide to get the workflow guide then implement the task: Role: Senior Python Developer responsible for code quality | Task: Perform comprehensive code review and cleanup of all multi-credential code. Ensure PEP 8 compliance, complete type hints, proper docstrings, remove debug code, and optimize performance. | Restrictions: Follow PEP 8 strictly, ensure all public APIs documented, do not change behavior during cleanup, use automated tools (pylint, mypy, black), maintain backward compatibility | Success: All code follows PEP 8, type hints complete, docstrings comprehensive, no debug code remains, performance optimized where applicable, passes linting and type checking. Mark task as [-] when starting and [x] when complete in .spec-workflow/specs/multi-credential-downloader/tasks.md_\n\n## Summary\n\n**Total Tasks**: 19\n**Estimated Effort**: 32-42 hours\n\n### Task Dependencies\n\n```\nPhase 1: Core Infrastructure (Tasks 1-10)\n1 → 3 (Credential model → tests)\n2 (Add tomli dependency - can be done independently)\n4 → 5 (Rotation state → tests)\n1, 2, 4 → 6 (Models + tomli → CredentialManager core with TOML support)\n6 → 7 (Manager core → validation)\n7 → 8 (Validation → manager tests)\n6 → 9 (Manager → ClientPool)\n9 → 10 (ClientPool → tests)\n\nPhase 2: CLI Integration (Tasks 11-14)\n1-10 → 11 (All Phase 1 → CLI update)\n11 → 12 (CLI update → rotation integration)\n12 → 13 (Rotation → error handling)\n1-13 → 14 (All → integration tests)\n\nPhase 3: Documentation and Testing (Tasks 15-19)\n1-14 → 15, 16 (All → documentation - TOML example + README)\n1-16 → 17 (All → full test suite)\n1-17 → 18 (All → E2E testing with TOML)\n1-18 → 19 (All → final review)\n```\n\n### Quality Gates\n\n- All unit tests passing (>80% coverage)\n- All integration tests passing\n- PEP 8 compliance (pylint score >8.0)\n- Type checking passing (mypy --strict)\n- Manual E2E testing completed\n- Documentation complete and reviewed\n- Backward compatibility verified\n",
  "fileStats": {
    "size": 31250,
    "lines": 298,
    "lastModified": "2025-10-16T14:57:49.578Z"
  },
  "comments": []
}